{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/how-to-insert-imagefile-into-my-db/","webpackCompilationHash":"bfc9e615db5bf5b314ae","result":{"data":{"markdownRemark":{"id":"16e50d39-87bc-5572-a409-60a5f27ea79b","html":"<figure>\n    <img src=\"/media/nature-photo6.jpeg\" alt=\"unsplash-film\">\n    <!-- <figcaption>Splendid</figcaption> -->\n</figure>\n<p>This post illustrates how I was able to insert imagefile from my os to my database. Django provides a built-in class specifically for images. <code class=\"language-text\">from django.core.files.images import ImageFile</code> inherits all the attributes and methods of File. When I open the Python shell, I have to import all the necessary files from my django project.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    ##import everything from my app models\n    from category.models import *\n    from users.models import *\n    from pins.models import *\n\n    #import necessary files to save local file images in my DB\n    from django.core.files.images.import ImageFile\n    from django.core.files import File</code></pre></div>\n<h2 id=\"how-to-knowchange-current-directory-in-python-shell\"><a href=\"#how-to-knowchange-current-directory-in-python-shell\" aria-label=\"how to knowchange current directory in python shell permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to know/change current directory in Python shell?</h2>\n<p>You can use the <code class=\"language-text\">os</code> module.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    &gt;&gt;&gt; import os\n    &gt;&gt;&gt; os.getcwd()  # check current path\n    &#39;/home/user&#39;\n    &gt;&gt;&gt; os.chdir(&quot;/tmp/&quot;) #change current directory\n    &gt;&gt;&gt; os.getcwd()\n    &#39;/tmp&#39;</code></pre></div>\n<ol>\n<li>My current path is</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    &gt;&gt;&gt; os.getcwd()\n    &#39;/home/jcs191072/Desktop/wecode/pinterest-backend&#39;</code></pre></div>\n<p>I thought my current path was <code class=\"language-text\">&#39;/home/jcs191072/Desktop/wecode/pinterest-backend&#39;</code> so additional path I need to add was<code class=\"language-text\">/pins/test.png</code> . But this is absolutely wrong path.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    &gt;&gt;&gt; b.background_img.save(&#39;test.png&#39;, File(open(&#39;/pins/test.png&#39;, &#39;r&#39;)))\n    Traceback (most recent call last):\n      File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;\n    FileNotFoundError: [Errno 2] No such file or directory: &#39;/pins/test.png&#39;</code></pre></div>\n<p>The right path is <code class=\"language-text\">&#39;pins/test.png&#39;</code> and I had to remove slash(/) to make it right.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    &gt;&gt;&gt; b = Category(name = &#39;animal&#39;)\n    &gt;&gt;&gt; b.background_img.save(&#39;test.png&#39;, File(open(&#39;pins/test.png&#39;, &#39;r&#39;)))\n    Traceback (most recent call last):\n      File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;\n      File &quot;/home/jcs191072/miniconda3/envs/pinterest-backend/lib/python3.7/site-packages/django/db/models/fields/files.py&quot;, line 87, in save\n        self.name = self.storage.save(name, content, max_length=self.field.max_length)\n      File &quot;/home/jcs191072/miniconda3/envs/pinterest-backend/lib/python3.7/site-packages/django/core/files/storage.py&quot;, line 52, in save\n        return self._save(name, content)\n      File &quot;/home/jcs191072/miniconda3/envs/pinterest-backend/lib/python3.7/site-packages/django/core/files/storage.py&quot;, line 270, in _save\n        for chunk in content.chunks():\n      File &quot;/home/jcs191072/miniconda3/envs/pinterest-backend/lib/python3.7/site-packages/django/core/files/base.py&quot;, line 60, in chunks\n        data = self.read(chunk_size)\n      File &quot;/home/jcs191072/miniconda3/envs/pinterest-backend/lib/python3.7/codecs.py&quot;, line 322, in decode\n        (result, consumed) = self._buffer_decode(data, self.errors, final)\n    UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0x89 in position 0: invalid start byte</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">After solving the path issue,I get this error:\n\n&gt; `UnicodeDecodeError: &#39;utf-8&#39; codec can&#39;t decode byte 0x80 in position 0: invalid start byte`</code></pre></div>\n<p>The solution is opening the files in binary mode (‘rb’).</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&gt;&gt;&gt; b.background_img.save(&#39;test.png&#39;, File(open(&#39;pins/test.png&#39;, &#39;rb&#39;)))\n&gt;&gt;&gt; b.save()</code></pre></div>\n<p>Successfully, I can insert all the required data including imagefile into my db.</p>\n<figure>\n    <img src=\"/media/pinterest_db.png\" alt=\"unsplash-film\">\n    <!-- <figcaption>Splendid</figcaption> -->\n</figure>\n<hr>\n<blockquote>\n<p><strong>We are creating wealth every time we write a code</strong></p>\n</blockquote>","fields":{"slug":"/posts/how-to-insert-imagefile-into-my-db/","tagSlugs":["/tag/python/","/tag/my-sql/","/tag/os-getcwd/","/tag/imagefield/"]},"frontmatter":{"date":"2019-08-23T16:25:11.199Z","description":"This post illustrates how I was able to insert imagefile from my os to my database.","tags":["Python","MySQL","os.getcwd()","imagefield"],"title":"[MySQL] How to insert imagefile into my db"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/how-to-insert-imagefile-into-my-db/"}}}